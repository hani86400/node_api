FROM node:24-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --omit=dev
RUN npm prune --omit=dev && npm cache clean --force && rm -rf /usr/share/doc /usr/share/man /tmp/*
COPY . .
RUN rm -f .env db/api.sqlite3  # just to be safe; these come from host
EXPOSE 3000
CMD ["node", "api.js"]